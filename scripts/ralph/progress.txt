# Ralph Progress Log
Started: 2026-01-14

## Codebase Patterns
- Firebase JS SDK used (not @react-native-firebase) for web compatibility
- User documents auto-created on anonymous auth in AuthContext
- Use `writeBatch()` for atomic multi-document operations
- Firestore security rules require `createdAt` field on user documents

---

## 2026-01-14 - US-001 (Fix Auth Flow) âœ…
Thread: https://ampcode.com/threads/T-019bbae3-4db0-7208-aa9f-ea7393030e39

### What was implemented
Fixed anonymous auth flow that was failing due to race condition:
1. AuthContext now auto-creates user document on anonymous sign-in
2. Added proper cleanup of Firestore listeners on auth state change
3. Fixed Firestore security rules for join flow

### Files changed
- `TwoCupsApp/src/context/AuthContext.tsx` - Auto-create user doc, fix listeners
- `firestore.rules` - Relaxed rules for join flow (read users, couples, players)

### Learnings
- Anonymous auth doesn't auto-create user documents - must do it manually
- Firestore security rules must allow reading partner's user doc for join flow
- Use `firebase deploy` (not `--only hosting`) for reliable deploys

---

## 2026-01-14 - US-002 (HomeScreen with Cup Visualizations) âœ…
Thread: https://ampcode.com/threads/T-019bbae3-4db0-7208-aa9f-ea7393030e39

### What was implemented
- CupVisualization component with fill level display
- usePlayerData hook for real-time player data from Firestore
- HomeScreen shows My Cup, Partner Cup, Collective Cup with gem counts
- Navigation buttons for Make Request, Log Attempt, Acknowledge

### Files created
- `src/components/cups/CupVisualization.tsx`
- `src/hooks/usePlayerData.ts`
- `src/hooks/index.ts`

---

## 2026-01-14 - US-003 (Log Attempt Screen) ðŸ”„ IN PROGRESS
Thread: https://ampcode.com/threads/T-019bbae3-4db0-7208-aa9f-ea7393030e39

### What was implemented
- LogAttemptScreen with action input, description, category picker
- Shows partner's active requests at top (for fulfillment bonus)
- Submits attempt to Firestore, awards gems
- Navigation from HomeScreen working

### Files created
- `src/screens/LogAttemptScreen.tsx`

### Status
Deployed, needs user testing to verify.

---
